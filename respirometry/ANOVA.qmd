# Document for Anova analysis check the git link for the tutorial

# ANOVA notes with input

what is it? stat test to see if two or more pop means are different.

primarily used to compare 3 or more groups

# Test we are using is one-way anova specifically

If the between variance is significantly larger than the within variance, the group means are declared to be different

variance comparison done using the ratio (variance between/ variance within)

after ratio is complete compare to fisher probability threshold (F-test)

How to do (example using the penguins data set):

#install.packages("palmerpenguins")

#library(palmerpenguins)

#library(tidyverse) \# dat \<- penguins %\>% \# select(species, flipper_length_mm)

#replace this with the resp or Photosynth data \#

note: the pipe operator (%\>%) takes the output of the expression on its left and passes it as the first argument to the function on its right

#summary(dat)

Aim of ANOVA: #study whether measurements are similar across different modalities (also called levels or treatments in the context of ANOVA) of a categorical variable #compare the impact of the different levels of a categorical variable on a quantitative variable #explain a quantitative variable based on a qualitative variable

# Null and Alternative hypothesis

H0: 1=2=3 (equal across the data sets)

H1: AT LEAST one is different from the other two (could be any of the lot)

large sample is n \>= 30

if normality is assumed, test the homogeneity of variances #variances equal, ANOVA #variances not equal, Welch ANOVA #normality not assumed, Kruskal-Wallis test

## Direct implication:

Anemone treatments are the variables

# How to do it
#install tidyverse, dplyr, car and load 

```{r}
if ("tidyverse" %in% rownames(installed.packages()) == 'FALSE') install.packages('tidyverse')
if ("dplyr" %in% rownames(installed.packages()) == 'FALSE') install.packages('dplyr')
if ("car" %in% rownames(installed.packages()) == 'FALSE') install.packages('car')

library(dplyr)
library(tidyverse)
library(car)
library(ggplot2)
```
```{r}
install.packages("ggplot2")
```
```{r}
library(ggplot2)
```


```{r}
rates <- read.csv('rates.csv')

```

#Respiration
```{r}
ggplot(rates) +
  aes(x = treatment, y = massnorm_resp_rate, color = treatment) +
  geom_jitter() +
  theme(legend.position = "none")
```

## Data normality
```{r}
resp_aov <-  aov(massnorm_resp_rate ~ treatment, data = rates)
```

```{r}
par(mfrow = c(1, 2)) # combine plots

# histogram
hist(resp_aov$residuals)

# QQ-plot
qqPlot(resp_aov$residuals,
  id = FALSE # id = FALSE to remove point identification
)
```
## Boxplot
```{r}
ggplot(rates) +
  aes(x = treatment, y = massnorm_resp_rate, fill = treatment) +
  geom_boxplot() +  
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(
    title = "Concentration vs. Respiration Rate",
    x = "Leachate concentration (mg/L)",
    y = "Respiration Rate"
  ) +
  scale_x_discrete(labels = c("Control ", "PPa 0.01", "PPa 0.1","PPa 1", "PPa 10", "PPa 100","PVC 0.01", "PVC 0.1", "PVC 1", "PVC 10", "PVC 100")) +  
  scale_fill_manual(values = c("seashell", "coral", "coral1","coral2","coral3", "coral4","dodgerblue","dodgerblue1","dodgerblue2", "dodgerblue3","dodgerblue4"))+ 
  

```
## ANOVA
```{r}
resp_aov <- aov(massnorm_resp_rate ~ treatment,
  data = rates
)

summary(resp_aov)
```



# Photosynthesis

## First glimpse of data
```{r}
ggplot(rates) +
  aes(x = treatment, y = massnorm_phot_rate, color = treatment) +
  geom_jitter() +
  theme(legend.position = "none")
```

## Data normality
```{r}
res_aov <-  aov(massnorm_phot_rate ~ treatment, data = rates)
```

```{r}
par(mfrow = c(1, 2)) # combine plots

# histogram
hist(res_aov$residuals)

# QQ-plot
qqPlot(res_aov$residuals,
  id = FALSE # id = FALSE to remove point identification
)
```

## Boxplot
```{r}
ggplot(rates) +
  aes(x = treatment, y = massnorm_phot_rate) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## ANOVA
```{r}
phot_aov <- aov(massnorm_phot_rate ~ treatment,
  data = rates
)

summary(phot_aov)
```


